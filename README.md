# Описание архитектуры нейронной сети
***
В данной лабораторной работе мы обучали сверточную нейронную сеть для решения задачи классификации изображений дикой природы Oregon wildlife. Данный датасет Oregon_wildlife включает в себя около 14.000 картинок дикой природы, которые распределены на 20 различных категорий. Для обучения нашей нейронной сети мы использовали 50 эпох, т.е. весь наш датасет пройдет через нейронную сеть 50 раз. Все 50 эпох мы раздели на части (батчи) размером 512 объектов в каждом батче.  
***
Как уже говорилось мы использовали сверточную нейронную сеть, а именно, двумерную (2D) сверточную нейронную сеть. Поэтому важной составляющей нашей нейронной сети является наличие сверточных слоев. Сверточные слои добавлены к нашей нейронной сети с использованием следующей функции Conv2D:  
```
x = tf.keras.layers.Conv2D(filters=8, kernel_size=3)(inputs)
```
***
Основная задача сверточного слоя – это применение математической операции свертка. Поэтому важными составляющими нашего сверточного слоя являются ядра свертки (фильтры). Соответственно наши ядра характеризуются размером, т.к. у нас 2D сверка, то у нас будет двумерная квадратная матрица определенного размера (в данном случае 3*3). Всего в одном сверточном слое у нас 8 фильтров, каждый фильтр будет применяться к изображению. Изображение также представляет из себя некоторую двумерную матрицу определенного размера.
***
Благодаря ядру мы постепенно “скользим” по нашему изображению  и выполняем операцию свертки, а именно, поэлементно умножаем элементы нашего изображения на соответствующие элементы матрицы ядра и затем все эти произведения суммируем между собой. Далее с определенным шагом мы переходим к следующей части нашего изображения. Таким образом, наше ядро будет перемещаться по всему изображению с определенным шагом сначала по горизонтали, а затем по вертикали. Соответственно на выходе мы получаем некоторую выходную матрицу с элементами, которые получились в результате свертки, т.е. признаки на выходе являются взвешенными суммами признаков на входе.  
***
В самом начале матрица ядра свертки содержит в себе случайные значения элементов (весов). Соответственно в процессе обучения нашей нейронной сети  каждое значение элементов нашей матрицы ядра модифицируются таким образом, чтобы решать уже какую-то конкретную задачу, а именно, выделение каких-то конкретных признаков для решения задачи классификации. 
После получения свернутого изображения производится операция подвыборки (Max-Pooling):  
```
x = tf.keras.layers.MaxPool2D()(x)
```
***
Данная операция позволяет сгруппировать пиксели изображения и уплотнить их, т.е. уменьшить размер изображения. Она сгруппирует пиксели в участке определенного размера и выберет элемент с наибольшим значением, поэтому мы сожмем изображение и подчеркнем некоторые признаки.  
***
Для того чтобы увеличить количество сверточных слоев мы добавили еще 3 дополнительных сверточных двумерных слоя, с помощью Conv2D и к ним добавили 3 подвыборочных слоя Max-Pooling (выбор максимального). 
```
x = tf.keras.layers.Conv2D(filters=8, kernel_size=3)(inputs)  
x = tf.keras.layers.MaxPool2D()(x)  
x = tf.keras.layers.Conv2D(filters=8, kernel_size=3)(inputs)  
x = tf.keras.layers.MaxPool2D()(x)  
x = tf.keras.layers.Conv2D(filters=8, kernel_size=3)(inputs)  
x = tf.keras.layers.MaxPool2D()(x)  
x = tf.keras.layers.Conv2D(filters=8, kernel_size=3)(inputs)  
x = tf.keras.layers.MaxPool2D()(x)
```
***
В результате получили двумерную сверточную нейронную сеть с количеством сверточных слоев 4.   
# После обучения данных нейронных сетей получили следующие графики:
График точности для сверточной нейронной сети с одним сверточных слоем:
![accuracy 512_batch_size](https://user-images.githubusercontent.com/59259102/110211637-342a8100-7ea0-11eb-92d8-e1555b53729e.jpg)  
График потерь для сверточной нейронной сети с одним сверточных слоем:
![loss 512_batch_size](https://user-images.githubusercontent.com/59259102/110211665-50c6b900-7ea0-11eb-851d-3d5912691f13.jpg)

